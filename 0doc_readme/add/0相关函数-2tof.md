[TOC]

### 0.相关函数

```c++
create_tube();//管道
create_array_wedge();//楔块
create_weld();//焊接
create_beam();//光束
create_focal();//聚焦方式

tube_radius_inner//内径
```

1. **create_tube();//管道**

   这个函数 `create_tube` 的主要目的是根据用户在界面上的输入参数，创建一个管道的几何模型，并在可视化窗口中显示。

2. **create_array_wedge();//创建和放置探测器**

   ![image-20240311154626614](D:/0work/学习资料/readme/C++.assets/image-20240311154626614.png)

   根据函数名 `create_array_wedge`，"array" 表示晶片的数目(楔块斜面上的东西)，这些实例按照某种规律排列组成数组。而 "wedge" 则指示这些实例是楔块的形状。

   [GeoModelcreate_probe和GeoModelplace_probe定义解释](./add2/GeoModelcreate_probe和GeoModelplace_probe.md)

   这两个函数的具体实现会依赖于整个程序的架构和需求。它们的目的是提供一个清晰的接口，使得在程序中创建和放置探测器变得方便，并能够在图形界面中显示出来。

3. **create_weld();//焊接**

   ![image-20240311152426251](D:/0work/学习资料/readme/C++.assets/image-20240311152426251.png)

   - `g`：Gap间隙
   - `angle`：Angle角度
   - `s`：Length焊缝长度
   - `h1`：Height 1
   - `h2`：Height 2

   [参数含义带图片](./add2/焊接g_a_s_h1_h2.md)

   这个函数 `create_weld` 的主要目的是在管道的特定位置创建一个焊接处的几何模型，并在可视化窗口中显示出来。

4. **create_beam();//在VTK窗口中显示生成的光束。**

   检查管道和探测器是否存在，如果不存在则直接返回。

   根据用户选择的聚焦方式（无聚焦、深度、声程），设置标志 a 的值。

   根据用户设置和探测器、楔块、管道的参数，生成光束的部分参数。

   根据生成的部分参数创建光束。

   如果之前存在光束，从VTK窗口中移除先前的光束。

   将新创建的光束赋值给成员变量 beam，并将其添加到VTK窗口中。

   执行VTK窗口的渲染操作，以更新显示。

5. **create_focal();//根据不同的聚焦方式（无聚焦、深度、声程），在可视化窗口中显示相应的聚焦点。**

   - **检查管道、探测器和光束是否存在：**
     - 如果管道模型 `tube` 不存在、探测器 `probe` 不存在或光束 `beam` 不存在，则直接返回，不执行后续的操作。
   - **根据聚焦方式进行不同的处理：**
     - 如果聚焦方式是 "无聚焦"（"No Focusing"）：
       - 如果已经存在聚焦点模型（`focal` 对象），则从可视化窗口中移除它。
       - 将 `focal` 对象设置为 `nullptr`。
       - 执行窗口的渲染操作。
     - 如果聚焦方式是 "深度"（"Depth"）：
       - 调用 `GeoModel::focal_point_sector_depth` 函数，该函数可能用于根据深度、光束的扇区配置和管道属性创建深度聚焦点的模型。
       - 如果已经存在聚焦点模型（`focal` 对象），则从可视化窗口中移除它。
       - 将新创建的深度聚焦点模型添加到可视化窗口中，并将 `focal` 对象设置为新创建的模型。
       - 执行窗口的渲染操作。
     - 如果聚焦方式是 "声程"（"Sound Path"）：
       - 调用 `GeoModel::focal_point_sector_sound_path` 函数，该函数可能用于根据声程、光束的扇区配置创建声程聚焦点的模型。
       - 如果已经存在聚焦点模型（`focal` 对象），则从可视化窗口中移除它。
       - 将新创建的声程聚焦点模型添加到可视化窗口中，并将 `focal` 对象设置为新创建的模型。
       - 执行窗口的渲染操作。
     - 如果聚焦方式不是上述三种情况，即 "do nothing"。

   这个函数的设计看起来是为了根据用户选择的聚焦方式，展示相应的聚焦点，以便在仿真或可视化中模拟不同聚焦方式下的探测效果。

![image-20240311134906018](D:/0work/学习资料/readme/C++.assets/image-20240311134906018.png)

### 1.外径 内径 长度 声速

![image-20240311152437480](D:/0work/学习资料/readme/C++.assets/image-20240311152437480.png)

在管道工程中，常见的参数包括外径、内径、长度和声速，它们代表如下：

1. **外径（Outside Diameter，OD）：**
   - 外径是管道横截面的直径，即管道外部的最大直径。在规格中通常以英寸（inches）或毫米（millimeters）为单位表示。外径对于管道的选择和安装非常重要，因为它直接影响到管道的强度和连接方式。

2. **内径（Inside Diameter，ID）：**
   - 内径是管道横截面内的直径，即管道中空部分的直径。与外径一样，内径通常以英寸或毫米为单位表示。内径对于液体或气体的流体动力学特性和管道内部空间的利用都是重要的。

3. **长度（Length）：**
   - 长度是管道的线性尺寸，通常以英尺（feet）、米（meters）或其他长度单位表示。管道的长度是指整个管道的长度，可能包括管道的直线部分以及任何弯曲或连接部分。

4. **声速（Speed of Sound）：**
   - 在管道工程中，声速是指在管道中传播的声波的速度。声速通常以单位时间内传播的距离（例如，米/秒）表示。在一些工程应用中，测量声速可以用于检测管道中的流体类型或测量流体的流速等。

这些参数在设计、安装和维护管道系统时都是非常关键的。

外径和内径影响到管道的强度和流体运动特性，

长度用于计算管道的体积和维护，

而声速可以在一些特殊的应用中提供额外的信息。

### 2.飞行时间Time of flight

![image-20240311140401128](D:/0work/学习资料/readme/C++.assets/image-20240311140401128.png)

TOF（Time of Flight）飞行时间是一种常见的测距技术，广泛应用于激光雷达、摄像头等领域。TOF的测距原理基于光的传播速度，通过测量光的飞行时间来确定距离。

聚焦方式对TOF测距结果有影响，主要表现在以下几个方面：

1. **无聚焦（Unfocused）：**
   - 当TOF系统没有聚焦时，激光束发散较大，照射到目标后，反射光也会以更大的角度散射回来。
   - 这可能导致在接收端接收到的反射光强度分布更广，使测距的精确度降低。

2. **深度聚焦（Depth of Focus）：**
   - 深度聚焦是指TOF系统允许一定范围内的深度都能够被清晰测量。
   - 这样，即使目标在深度方向上有一定的变化，TOF系统也能够保持相对较高的测距精度。

3. **声程聚焦（Phase Focusing）：**
   - 在TOF中，声程聚焦通常指通过测量光的相位来实现聚焦。
   - 通过精确测量光波的相位，可以更准确地确定飞行时间，从而提高测距精度。

总体而言，聚焦方式的选择会影响TOF系统的性能和测距精度。

无聚焦可能导致反射光强度分布较广，从而降低测距的准确性。

深度聚焦和声程聚焦能够提高TOF系统在深度方向上的测距精度，但需要更复杂的算法和硬件支持。

在实际应用中，选择适当的聚焦方式取决于具体的测距要求和应用场景。不同的场景可能需要权衡测距范围、测距精度和系统复杂度等因素。